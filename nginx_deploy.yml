apiVersion: apps/v1
kind: Deployment
metadata:
 name: nginx-deploy
 labels:
  app: front-nginx01-deploy
 annotations:
  buildversion: 1.0.1

spec:
 template:
  metadata:
   name: nginx01-pod
   labels:
    app: nginx01-front-pod
  spec:
   containers:
   - name: nginx01-cont
     image: nginx:latest
     resources:
      requests:
        cpu: "200m"
        memory: "128Mi"
      limits:
        cpu: "500m"
        memory: "512Mi"
     envFrom:
     - configMapRef:
        name: nginx-config-map

     volumeMounts:
      - mountPath: /var/logs
        name: log-volume

   volumes:
    - name: log-volume
      persistentVolumeClaim:
        claimName: pvc-local

   initContainers:
    - name: init-cont
      image: busybox
      command:
        - sh
        - -c
        - sleep 5


   affinity:
      nodeAffinity:
        requiredDuringSchedulingIgnoredDuringExecution:
          nodeSelectorTerms:
            - matchExpressions:
              - key: size
                operator: In
                values:
                - large
 replicas: 3
 selector:
  matchLabels:
   app: nginx01-front-pod
